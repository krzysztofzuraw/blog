---
title: Customizing Gatsby Graphql schema
date: '2020-03-04T17:51:03.284Z'
slug: '/blog/2020/customizing-gatsby-graphql-schema'
tags:
  - graphql
  - schema
  - typescript
  - codegen
  - til
---

Recently I was doing redesign of my blog. As you may know, I used
[Gatsby.js](https://www.gatsbyjs.org/). All in all, it is a very good static site
generator but I had one problem with it. Or to be more precise the issue was
with Gatsby and the TypeScript.

## Problem

I try to help myself when writing frontend code so I decided that I will try to
automatically generate TypeScript interfaces from GraphQL schema that Gatsby.js
is using. Everything was fine until I found out that by design many fields are
undefined. Take for example `siteMetadata` object:

```js
{
siteMetadata: {
    siteName: 'Krzysztof ≈ªuraw',
    author: 'Krzysztof ≈ªuraw',
    description: 'Krzysztof ≈ªuraw personal site & blog',
    siteUrl: 'https://krzysztofzuraw.com',
    social: {
      linkedin: 'https://pl.linkedin.com/in/krzysztofzuraw',
      github: 'https://github.com/krzysztofzuraw',
      email: 'mailto:blog@kzuraw.com',
      pinboard: 'https://pinboard.in/u:KZuraw',
      newsletter: 'https://buttondown.email/krzysztof_zuraw',
    },
  }
}
```

You can see this file [here](https://github.com/krzysztofzuraw/blog/blob/master/gatsby-config.js).

I tried to generate TypeScript types for this structure using [GraphQL Code Generator](https://graphql-code-generator.com/) to get:

```ts
export type SiteSiteMetadata = {
  __typename?: 'SiteSiteMetadata';
  siteName?: Maybe<Scalars['String']>;
  author?: Maybe<Scalars['String']>;
  description?: Maybe<Scalars['String']>;
  siteUrl?: Maybe<Scalars['String']>;
  social?: Maybe<SiteSiteMetadataSocial>;
};
```

What? All of them are `undefined` or `null`? No way - I know they will be defined in the time
when I generate a static site. I asked around and [Hasparus](https://haspar.us/) give me a hint - you
can customize your GraphQL schema üéâ.

To do that I had to use [createSchemaCustomization](https://www.gatsbyjs.org/docs/schema-customization/)
(you have to place it inside `gatsby-node.js`):

```js
exports.createSchemaCustomization = ({ actions }) => {
  const { createTypes } = actions;
  const typeDefs = `
  type MarkdownRemark implements Node {
    frontmatter: Frontmatter!
  }
  type Frontmatter {
    tags: [String!]!
    title: String!
    slug: String!
    date(
      difference: String
      formatString: String
      fromNow: Boolean
      locale: String
    ): Date!
  }
  type Site implements Node {
    siteMetadata: SiteSiteMetadata!
  }
  type SiteSiteMetadata {
    siteName: String!
    author: String!
    description: String!
    siteUrl: String!
    social: SiteSiteMetadataSocial!
  }
  type SiteSiteMetadataSocial {
    linkedin: String!
    github: String!
    email: String!
    pinboard: String!
    newsletter: String!
  }
  `;
  createTypes(typeDefs);
};
```

What is happening here? I added my own GraphQL types where all the fields are not nullable.
Thanks to that it generated types look like follows:

```ts
export type SiteSiteMetadata = {
  __typename?: 'SiteSiteMetadata';
  siteName: Scalars['String'];
  author: Scalars['String'];
  description: Scalars['String'];
  siteUrl: Scalars['String'];
  social: SiteSiteMetadataSocial;
};
```

One drawback of it - right now it is on me as a developer, to make sure that all the
data from e.g `frontmatter` will be there.

## Summary

I wanted to fix autogenerated GraphQL types in Gatsby. Thanks to [Hasparus](link) suggestion I've
used [createSchemaCustomization](https://www.gatsbyjs.org/docs/schema-customization/) to override
guested Gatsby types.

Thank you Hasparus once again üôáüèª‚Äç‚ôÇÔ∏è.
